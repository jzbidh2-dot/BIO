<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Minh Tri·∫øt - Social Media Services</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;700;900&display=swap" rel="stylesheet">
    
    <style>
        :root { --primary: #8b5cf6; --secondary: #ec4899; --dark: #0f172a; }
        body { font-family: 'Outfit', sans-serif; background-color: var(--dark); color: white; overflow-x: hidden; }
        
        /* Hi·ªáu ·ª©ng n·ªÅn */
        .bg-animated { background: radial-gradient(circle at 50% 50%, #1e1b4b, #000); position: fixed; inset: 0; z-index: -1; }
        .orb { position: absolute; border-radius: 50%; filter: blur(80px); opacity: 0.4; animation: float 10s infinite ease-in-out; }
        .orb-1 { top: -10%; left: -10%; width: 50vw; height: 50vw; background: var(--primary); }
        .orb-2 { bottom: -10%; right: -10%; width: 40vw; height: 40vw; background: var(--secondary); animation-delay: -5s; }

        .glass-panel { background: rgba(255, 255, 255, 0.03); backdrop-filter: blur(16px); border: 1px solid rgba(255, 255, 255, 0.05); box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1); }
        
        .btn-grad { background-image: linear-gradient(to right, #DA22FF 0%, #9733EE 51%, #DA22FF 100%); transition: 0.5s; background-size: 200% auto; color: white; border-radius: 12px; }
        .btn-grad:hover { background-position: right center; transform: translateY(-2px); box-shadow: 0 10px 20px rgba(139, 92, 246, 0.3); }
        
        /* Chat Widget Animations */
        #chat-widget { transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); transform: translateY(120%) scale(0.9); opacity: 0; }
        #chat-widget.active { transform: translateY(0) scale(1); opacity: 1; }
        
        .msg-enter { animation: slideIn 0.3s ease-out forwards; opacity: 0; transform: translateY(10px); }
        @keyframes slideIn { to { opacity: 1; transform: translateY(0); } }
        @keyframes float { 0%, 100% {transform: translate(0,0);} 50% {transform: translate(20px, 20px);} }

        /* Custom Scrollbar */
        .custom-scroll::-webkit-scrollbar { width: 4px; }
        .custom-scroll::-webkit-scrollbar-track { background: transparent; }
        .custom-scroll::-webkit-scrollbar-thumb { background: #4b5563; border-radius: 10px; }

        /* Typing Indicator */
        .typing-dot { display: inline-block; width: 6px; height: 6px; border-radius: 50%; background-color: #fff; animation: typing 1.4s infinite ease-in-out both; margin: 0 2px; }
        .typing-dot:nth-child(1) { animation-delay: -0.32s; }
        .typing-dot:nth-child(2) { animation-delay: -0.16s; }
        @keyframes typing { 0%, 80%, 100% { transform: scale(0); } 40% { transform: scale(1); } }
    </style>
</head>
<body class="flex items-center justify-center min-h-screen p-4">

    <div class="bg-animated"><div class="orb orb-1"></div><div class="orb orb-2"></div></div>

    <div class="glass-panel w-full max-w-5xl rounded-3xl flex flex-col md:flex-row overflow-hidden relative z-10 shadow-2xl">
        
        <div class="md:w-[35%] p-8 flex flex-col items-center text-center border-b md:border-b-0 md:border-r border-white/5 bg-black/20 relative">
            <div class="relative w-40 h-40 mb-5 group">
                <div class="absolute inset-0 bg-gradient-to-r from-pink-500 to-purple-500 rounded-full blur opacity-75 group-hover:opacity-100 transition duration-500"></div>
                <img id="u-avatar" src="https://sf-static.upanhlaylink.com/img/image_202512052dab5184a8ed01d8e49aa61e8f6d66b5.jpg" class="relative w-full h-full rounded-full object-cover border-4 border-[#1a1a1a] z-10">
                <div class="absolute bottom-2 right-2 w-5 h-5 bg-green-500 rounded-full border-4 border-[#1a1a1a] z-20"></div>
            </div>
            
            <h1 id="u-name" class="text-3xl font-black text-white mb-2 tracking-tight">MINH TRI·∫æT</h1>
            <p id="u-bio" class="text-sm text-purple-300 font-semibold tracking-widest uppercase mb-8">SOCIAL SUPPORT</p>
            
            <div class="w-full grid grid-cols-2 gap-3 mt-auto">
                <a href="https://www.facebook.com/nguyen.minh.triet.71039/" target="_blank" class="glass-panel hover:bg-white/10 text-white py-3 rounded-xl font-bold flex items-center justify-center gap-2 transition"><i class="fab fa-facebook-f text-blue-500"></i> Facebook</a>

<a href="https://zalo.me/0383539399" target="_blank" class="glass-panel hover:bg-white/10 text-white py-3 rounded-xl font-bold flex items-center justify-center gap-2 transition"><i class="fas fa-phone text-green-500"></i> Zalo</a>
               
                <button onclick="toggleModal('price-modal')" class="col-span-2 btn-grad py-3.5 font-bold flex items-center justify-center gap-2 shadow-lg hover:shadow-purple-500/30"><i class="fas fa-crown"></i> B·∫¢NG GI√Å VIP</button>
            </div>
        </div>

        <div class="flex-1 p-8 md:p-10 bg-black/10">
            <h2 class="text-2xl font-bold text-white mb-8 flex items-center gap-3">
                <span class="w-1.5 h-8 bg-gradient-to-b from-purple-500 to-pink-500 rounded-full"></span> 
                D·ªäCH V·ª§ H·ªñ TR·ª¢
            </h2>
            
            <div class="grid grid-cols-1 gap-4">
                <button onclick="window.ai.trigger('hack')" class="glass-panel p-5 rounded-2xl flex items-center gap-5 hover:bg-white/5 transition group text-left border border-transparent hover:border-purple-500/30">
                    <div class="w-14 h-14 rounded-2xl bg-gradient-to-br from-red-500/20 to-red-900/20 text-red-500 flex items-center justify-center text-2xl group-hover:scale-110 transition duration-300 shadow-inner"><i class="fas fa-shield-virus"></i></div>
                    <div>
                        <div class="font-bold text-lg group-hover:text-red-400 transition">Kh√¥i Ph·ª•c T√†i Kho·∫£n</div>
                        <div class="text-xs text-gray-400 mt-1">L·∫•y l·∫°i Nick Hack, Qu√™n m·∫≠t kh·∫©u</div>
                    </div>
                </button>

                <button onclick="window.ai.trigger('282')" class="glass-panel p-5 rounded-2xl flex items-center gap-5 hover:bg-white/5 transition group text-left border border-transparent hover:border-orange-500/30">
                    <div class="w-14 h-14 rounded-2xl bg-gradient-to-br from-orange-500/20 to-orange-900/20 text-orange-500 flex items-center justify-center text-2xl group-hover:scale-110 transition duration-300 shadow-inner"><i class="fas fa-id-card"></i></div>
                    <div>
                        <div class="font-bold text-lg group-hover:text-orange-400 transition">M·ªü Kh√≥a 282 / 956</div>
                        <div class="text-xs text-gray-400 mt-1">X√°c minh danh t√≠nh, K√©t s·∫Øt t√≠m</div>
                    </div>
                </button>

                <button onclick="window.ai.trigger('faq')" class="glass-panel p-5 rounded-2xl flex items-center gap-5 hover:bg-white/5 transition group text-left border border-transparent hover:border-gray-500/30">
                    <div class="w-14 h-14 rounded-2xl bg-gradient-to-br from-gray-600/20 to-gray-900/20 text-gray-300 flex items-center justify-center text-2xl group-hover:scale-110 transition duration-300 shadow-inner"><i class="fas fa-gavel"></i></div>
                    <div>
                        <div class="font-bold text-lg group-hover:text-gray-300 transition">Kh√°ng Ngh·ªã FAQ</div>
                        <div class="text-xs text-gray-400 mt-1">X·ª≠ l√Ω t√†i kho·∫£n b·ªã V√¥ hi·ªáu h√≥a</div>
                    </div>
                </button>

                 <button onclick="window.ai.trigger('rip')" class="glass-panel p-5 rounded-2xl flex items-center gap-5 hover:bg-white/5 transition group text-left border border-transparent hover:border-purple-500/30">
                    <div class="w-14 h-14 rounded-2xl bg-gradient-to-br from-purple-500/20 to-purple-900/20 text-purple-400 flex items-center justify-center text-2xl group-hover:scale-110 transition duration-300 shadow-inner"><i class="fas fa-skull"></i></div>
                    <div>
                        <div class="font-bold text-lg group-hover:text-purple-400 transition">D·ªãch V·ª• Report (RIP)</div>
                        <div class="text-xs text-gray-400 mt-1">B·∫£o v·ªá th∆∞∆°ng hi·ªáu, x√≥a m·∫°o danh</div>
                    </div>
                </button>
            </div>
        </div>
    </div>

    <div id="price-modal" class="fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm p-4 opacity-0 pointer-events-none transition duration-300">
        <div class="w-full max-w-md bg-[#1a1a1a] border border-white/10 rounded-2xl overflow-hidden shadow-2xl transform scale-95 transition duration-300" id="price-content">
            <div class="bg-gradient-to-r from-purple-900 to-[#1a1a1a] p-6 flex justify-between items-center">
                <h3 class="text-xl font-bold text-white">B·∫¢NG GI√Å D·ªäCH V·ª§</h3>
                <button onclick="toggleModal('price-modal')" class="text-gray-400 hover:text-white"><i class="fas fa-times text-xl"></i></button>
            </div>
            <div class="p-6 space-y-4 text-sm">
                <div class="flex justify-between items-center p-3 bg-white/5 rounded-lg">
                    <span class="flex items-center gap-2"><i class="fas fa-shield-virus text-red-500"></i> Kh√¥i ph·ª•c Nick</span>
                    <span class="font-bold text-red-400 bg-red-500/10 px-2 py-1 rounded">Th∆∞∆°ng L∆∞·ª£ng</span>
                </div>
                <div class="flex justify-between items-center p-3 bg-white/5 rounded-lg">
                    <span class="flex items-center gap-2"><i class="fas fa-id-card text-orange-500"></i> Unlock 282/956</span>
                    <span class="font-bold text-orange-400 bg-orange-500/10 px-2 py-1 rounded">T·ª´ 199.000ƒë</span>
                </div>
                <div class="flex justify-between items-center p-3 bg-white/5 rounded-lg">
                    <span class="flex items-center gap-2"><i class="fas fa-skull text-purple-500"></i> Report/RIP</span>
                    <span class="font-bold text-purple-400 bg-purple-500/10 px-2 py-1 rounded">250.000ƒë</span>
                </div>
            </div>
            <div class="p-4 border-t border-white/10">
                <button onclick="window.ai.trigger('tuvan'); toggleModal('price-modal')" class="w-full bg-purple-600 hover:bg-purple-500 text-white font-bold py-3 rounded-xl transition">NH·∫ÆN TIN T∆Ø V·∫§N NGAY</button>
            </div>
        </div>
    </div>

    <div onclick="window.ai.toggle()" class="fixed bottom-6 right-6 cursor-pointer z-40 group">
        <div class="w-14 h-14 md:w-16 md:h-16 rounded-full shadow-[0_0_20px_rgba(139,92,246,0.5)] flex items-center justify-center overflow-hidden border-2 border-white hover:scale-110 transition bg-[#1a1a1a] relative z-10">
            <img src="https://cdn-icons-png.flaticon.com/512/8943/8943377.png" class="w-full h-full object-cover p-1">
        </div>
        <div class="absolute inset-0 rounded-full bg-purple-500 animate-ping opacity-20 z-0"></div>
        <div class="absolute -top-2 right-0 bg-red-600 text-white text-[10px] font-bold px-2 py-1 rounded-full animate-bounce z-20 shadow-sm">AI Support</div>
    </div>

    <div id="chat-widget" class="fixed bottom-24 right-4 left-4 md:left-auto md:right-6 md:w-[380px] h-[500px] bg-[#1a1a1a] rounded-2xl flex flex-col overflow-hidden z-40 border border-gray-700 shadow-2xl">
        <div class="bg-gradient-to-r from-indigo-600 to-purple-600 p-4 flex justify-between items-center text-white shrink-0">
            <div class="flex items-center gap-3">
                <div class="relative">
                    <img src="https://cdn-icons-png.flaticon.com/512/8943/8943377.png" class="w-10 h-10 rounded-full border border-white/20 bg-white/10 p-1">
                    <span class="absolute bottom-0 right-0 w-3 h-3 bg-green-500 border-2 border-[#1a1a1a] rounded-full"></span>
                </div>
                <div>
                    <span class="font-bold block text-sm">Tr·ª£ L√Ω ·∫¢o </span>
                    <span class="text-[10px] opacity-80 uppercase tracking-wider">Lu√¥n s·∫µn s√†ng</span>
                </div>
            </div>
            <button onclick="window.ai.toggle()" class="w-8 h-8 flex items-center justify-center rounded-full hover:bg-white/10 transition"><i class="fas fa-times"></i></button>
        </div>
        
        <div id="chat-area" class="flex-1 bg-black/40 p-4 overflow-y-auto space-y-4 custom-scroll relative">
            <div class="flex flex-col items-start msg-enter">
                <div class="bg-gray-800 text-gray-200 p-3 rounded-2xl rounded-tl-none text-sm border border-gray-700 shadow-sm max-w-[90%]">
                    ü§ñ Ch√†o anh/ch·ªã! Em l√† AI h·ªó tr·ª£ t·ª± ƒë·ªông.<br>Em c√≥ th·ªÉ gi√∫p g√¨ cho anh/ch·ªã ·∫°?
                </div>
            </div>
        </div>
        
        <div id="scan-ui" class="absolute inset-0 bg-black/90 z-50 hidden flex-col items-center justify-center text-green-400 font-mono">
            <div class="w-40 h-40 border-2 border-green-500/50 relative mb-4 rounded-lg overflow-hidden">
                <div class="absolute w-full h-1 bg-green-400 shadow-[0_0_15px_#4ade80] animate-[scan_2s_infinite]"></div>
                <img id="scan-img" class="w-full h-full object-cover opacity-50 blur-sm">
            </div>
            <p class="animate-pulse">ƒêANG PH√ÇN T√çCH ·∫¢NH...</p>
        </div>

        <div class="p-3 bg-[#111] border-t border-gray-700 flex gap-2 shrink-0">
             <label class="cursor-pointer text-gray-400 hover:text-purple-400 p-2 transition" title="G·ª≠i ·∫£nh">
                 <i class="fas fa-image text-xl"></i>
                 <input type="file" hidden accept="image/*" onchange="window.ai.handleImage(this)">
            </label>
            <input id="chat-inp" type="text" placeholder="Nh·∫≠p tin nh·∫Øn..." class="flex-1 bg-gray-800/50 text-white rounded-full px-4 text-sm outline-none border border-transparent focus:border-purple-500 transition" onkeypress="if(event.key=='Enter') window.ai.send()">
            <button onclick="window.ai.send()" class="w-10 h-10 flex items-center justify-center bg-purple-600 hover:bg-purple-500 text-white rounded-full transition shadow-lg shadow-purple-900/20"><i class="fas fa-paper-plane text-sm"></i></button>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/tesseract.js@5/dist/tesseract.min.js"></script>
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
        import { getDatabase, ref, push } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-database.js";

        const firebaseConfig = {
            apiKey: "AIzaSyBpb8c8MlQZICS0qtyKeH1LFaQ50J_SbHA",
            authDomain: "minhtriet-ai-7be2e.firebaseapp.com",
            projectId: "minhtriet-ai-7be2e",
            storageBucket: "minhtriet-ai-7be2e.firebasestorage.app",
            messagingSenderId: "931603134196",
            appId: "1:931603134196:web:8ebd2c6cbfc5de93c4d0a1",
            measurementId: "G-M85L8CM6VV"
        };

        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);

        // --- KHU V·ª∞C D·ªÆ LI·ªÜU C·ª¶A CH·ªä MINT (DATA_NAO) ---
        // Em ƒë√£ th√™m s·∫µn c√°c t√¨nh hu·ªëng ph·ªï bi·∫øn nh·∫•t
        const DATA_NAO = [
            // 1. CH√ÄO H·ªéI
            { key: "hi", ans: "D·∫° em ch√†o anh/ch·ªã! Em c√≥ th·ªÉ gi√∫p g√¨ cho m√¨nh ·∫°?" },
            { key: "hello", ans: "anh c·∫ßn h·ªï tr·ª£ g√¨ c·ª© n√≥i e." },
            { key: "ch√†o", ans: "D·∫° Minh Tri·∫øt xin ch√†o! Ch√∫c anh ch·ªã m·ªôt ng√†y t·ªët l√†nh." },
            { key: "alo", ans: "D·∫° em nghe ƒë√¢y ·∫°? M√¨nh c·∫ßn h·ªó tr·ª£ v·∫•n ƒë·ªÅ g√¨ th·∫ø ·∫°?" },
            { key: "c√≥ ai kh√¥ng", ans: "D·∫° em ƒë√¢y, em tr·ª±c 24/7 m√†." },

            // 2. GI√Å & THANH TO√ÅN
            { key: "gi√°", ans: "D·∫° t√πy d·ªãch v·ª• m√† gi√° kh√°c nhau. Anh ch·ªã b·∫•m n√∫t 'B·∫£ng Gi√° VIP' xem cho r√µ nh√©." },
            { key: "ti·ªÅn", ans: "D·∫° gi√° b√™n em l√† gi√° s√†n r·ªìi ·∫°. Inbox em b√°o gi√° c·ª• th·ªÉ nha." },
            { key: "bao nhi√™u", ans: "D·∫° ca n√†y gi√° dao ƒë·ªông. Anh g·ª≠i ·∫£nh l·ªói ƒë·ªÉ em b√°o gi√° chu·∫©n x√°c nh·∫•t ·∫°." },
            { key: "ƒë·∫Øt", ans: "Ti·ªÅn n√†o c·ªßa n·∫•y anh ∆°i. B√™n em l√†m uy t√≠n, b·∫£o h√†nh tr·ªçn ƒë·ªùi m√†." },
            { key: "r·∫ª", ans: "D·∫° r·∫ª h∆°n n·ªØa coi ch·ª´ng g·∫∑p scam ƒë√≥ anh." },
            { key: "stk", ans: "üí≥ Vietcombank: 1036334933 - NGUYEN DUC BAO. Chuy·ªÉn xong ch·ª•p bill gi√∫p em nh√©." },
            { key: "momo", ans: " Momo em: 0794328504 (DUONG THI TUYET)." },
            { key: "c·ªçc", ans: "D·∫° d·ªãch v·ª• b√™n em c·∫ßn c·ªçc 50% ƒë·ªÉ ch·∫°y tool ·∫°." },

            // 3. M·ªû KH√ìA
            { key: "282", ans: "D·∫° l·ªói 282 (qu√©t khu√¥n m·∫∑t) b√™n em nh·∫≠n m·ªü 30p-24h v·ªÅ. Gi√° 199k." },
            { key: "956", ans: "D·∫° k√©t s·∫Øt t√≠m (956) ch√≠nh ch·ªß hay kh√¥ng ch√≠nh ch·ªß em ƒë·ªÅu c√¢n ƒë∆∞·ª£c h·∫øt." },
            { key: "k√©t s·∫Øt", ans: "D·∫° l·ªói 956 n√†y nh·∫≠n m·ªü qua mail ho·∫∑c ng√†y sinh. Anh g·ª≠i info qua Zalo em check nh√©." },
            { key: "v√¥ hi·ªáu h√≥a", ans: "V√¥ hi·ªáu h√≥a (FAQ) c√≥ nhi·ªÅu d·∫°ng (583, 723, 277...). Anh ch·ª•p m√†n h√¨nh em xem l√† d·∫°ng n√†o ·∫°." },
            { key: "faq", ans: "FAQ kh√°ng c·∫ßn CMT/CCCD chu·∫©n. Anh chu·∫©n b·ªã gi·∫•y t·ªù ch∆∞a ·∫°?" },
            { key: "b·ªã hack", ans: "B·ªã hack ƒë·ªïi pass/mail th√¨ nh·∫Øn Zalo em g·∫•p ƒë·ªÉ k·ªãp back l·∫°i nh√©." },
            { key: "qu√™n m·∫≠t kh·∫©u", ans: "Qu√™n m·∫≠t kh·∫©u th√¨ ph√≠ r·∫ª th√¥i ·∫°. Inbox em l·∫•y l·∫°i cho." },
            { key: "pass", ans: "L·∫•y l·∫°i pass Facebook gi√° sinh vi√™n th√¥i ·∫°." },
            { key: "m√£", ans: "M·∫•t m√£ 2FA (x√°c th·ª±c 2 y·∫øu t·ªë) b√™n em nh·∫≠n ph√° 15 ph√∫t l√† xong." },

            // 4. T∆Ø∆†NG T√ÅC
            { key: "like", ans: "D·∫° b√™n em c√≥ b√°n Like, Follow gi√° r·∫ª cho shop b√°n h√†ng." },
            { key: "follow", ans: "1000 Follow gi√° 50k. B·∫£o h√†nh kh√¥ng t·ª•t ·∫°." },
            { key: "tick xanh", ans: "L√™n t√≠ch xanh (Meta Verified) gi√° 3xxk/th√°ng. Inbox em h∆∞·ªõng d·∫´n." },

            // 5. RIP/REPORT
            { key: "rip", ans: "D·∫° RIP nick (Dame) gi√° 250k. ƒê·∫£m b·∫£o bay m√†u vƒ©nh vi·ªÖn." },
            { key: "x√≥a", ans: "Mu·ªën x√≥a nick ng∆∞·ªùi y√™u c≈© hay t√¨nh ƒë·ªãch ·∫°? G·ª≠i link ƒë√¢y em x·ª≠ l√Ω cho." },
            { key: "dame", ans: "Dame 277, Dame 808 b√™n em bao ch·∫•t." },

            // 6. UY T√çN
            { key: "l·ª´a ƒë·∫£o", ans: "Em l√†m ƒÉn l·∫•y c√°i t√¢m l√†m ƒë·∫ßu. Anh c√≥ th·ªÉ check legit (uy t√≠n) c·ªßa em tr√™n c√°c nh√≥m." },
            { key: "uy t√≠n", ans: "Anh c·ª© search sƒët em l√† ra th√¥ng tin li·ªÅn. Em l√†m ngh·ªÅ 5 nƒÉm r·ªìi." },
            { key: "b·∫£o h√†nh", ans: "B·∫£o h√†nh vƒ©nh vi·ªÖn cho anh. L·ªói l·∫°i em fix free." },
            
            // 7. KH√ÅC
            { key: "ƒë·ªãa ch·ªâ", ans: "Em ·ªü Vƒ©nh Long. Anh r·∫£nh qua m·ªùi em ly c√† ph√™ nh√©." },
            { key: "ngu", ans: "ngu c√°i l·ªìn tr√¢u nh√† m√†y" }
            
        ];

        // --- LOGIC CH√çNH ---
        window.toggleModal = (id) => {
            const modal = document.getElementById(id);
            if(modal.classList.contains('opacity-0')) {
                modal.classList.remove('opacity-0', 'pointer-events-none');
                modal.querySelector('#price-content').classList.remove('scale-95');
                modal.querySelector('#price-content').classList.add('scale-100');
            } else {
                modal.classList.add('opacity-0', 'pointer-events-none');
                modal.querySelector('#price-content').classList.remove('scale-100');
                modal.querySelector('#price-content').classList.add('scale-95');
            }
        }

        window.ai = {
            isOpen: false,
            toggle: () => { 
                window.ai.isOpen = !window.ai.isOpen; 
                const widget = document.getElementById('chat-widget');
                window.ai.isOpen ? widget.classList.add('active') : widget.classList.remove('active');
            },
            
            addMsg: (content, role, type='text') => {
                const box = document.getElementById('chat-area');
                const typing = document.getElementById('typing-indicator');
                if(typing) typing.remove();

                const d = document.createElement('div'); 
                d.className = `flex flex-col ${role=='user'?'items-end':'items-start'} msg-enter`;
                
                let inner = '';
                if(type === 'image') inner = `<img src="${content}" class="w-40 rounded-lg border border-gray-600 mb-2 shadow-md">`;
                else inner = `<div class="${role=='user'?'bg-purple-600 text-white shadow-lg shadow-purple-900/30':'bg-gray-800 text-gray-200 border border-gray-700'} p-3 rounded-2xl ${role=='user'?'rounded-tr-none':'rounded-tl-none'} text-sm max-w-[85%] leading-relaxed">${content}</div>`;
                
                d.innerHTML = inner;
                box.appendChild(d); box.scrollTop = box.scrollHeight;
                
                if(role === 'user') push(ref(db, 'logs'), { role, content, type, time: Date.now() });
            },

            showTyping: () => {
                const box = document.getElementById('chat-area');
                if(document.getElementById('typing-indicator')) return;
                const d = document.createElement('div');
                d.id = 'typing-indicator';
                d.className = 'flex flex-col items-start msg-enter';
                d.innerHTML = `<div class="bg-gray-800 p-3 rounded-2xl rounded-tl-none border border-gray-700 w-16 flex items-center justify-center gap-1"><div class="typing-dot"></div><div class="typing-dot"></div><div class="typing-dot"></div></div>`;
                box.appendChild(d); box.scrollTop = box.scrollHeight;
            },

            trigger: (key) => { 
                if(!window.ai.isOpen) window.ai.toggle();
                const map = {
                    'hack': { u: "T√¥i c·∫ßn h·ªó tr·ª£ l·∫•y l·∫°i t√†i kho·∫£n.", b: "ü§ñ Ch√†o anh, tr∆∞·ªùng h·ª£p n√†y gi√° s·∫Ω **Th∆∞∆°ng L∆∞·ª£ng** t√πy ƒë·ªô kh√≥. Anh vui l√≤ng g·ª≠i ·∫£nh l·ªói ho·∫∑c m√¥ t·∫£ chi ti·∫øt ƒë·ªÉ em b√°o gi√° nh√©." },
                    'faq': { u: "T√†i kho·∫£n t√¥i b·ªã V√¥ Hi·ªáu H√≥a (FAQ).", b: "ü§ñ D·∫°, ca n√†y b√™n em c·∫ßn check tr∆∞·ªõc. Anh g·ª≠i ·∫£nh m√†n h√¨nh l·ªói ƒë·ªÉ em xem c√≥ c·ª©u ƒë∆∞·ª£c kh√¥ng nha." },
                    '282': { u: "Nick b·ªã kh√≥a 282 / 956.", b: "ü§ñ D·∫°, m·ªü kh√≥a 282/956 b√™n em c√≥ gi√° ni√™m y·∫øt t·ª´ **199.000ƒë**. Anh g·ª≠i ·∫£nh ƒë·ªÉ em check d·∫°ng kh√≥a nh√©." },
                    'rip': { u: "T√¥i mu·ªën Report/RIP nick ng∆∞·ªùi kh√°c.", b: "ü§ñ D·ªãch v·ª• RIP nick b√™n em gi√° **250.000ƒë** (B·∫£o h√†nh x√≥a vƒ©nh vi·ªÖn). Anh g·ª≠i link nick c·∫ßn x·ª≠ l√Ω ·∫°." },
                    'tuvan': { u: "T√¥i c·∫ßn t∆∞ v·∫•n th√™m.", b: "D·∫° anh c·∫ßn h·ªó tr·ª£ g√¨ ·∫° c·ª© n√≥i e(n·∫•u kh√¥ng v·ª´a √Ω th√¨ xin li√™n h·ªá ad ·∫°)" }
                };
                const script = map[key] || map['tuvan'];
                window.ai.addMsg(script.u, 'user');
                window.ai.showTyping();
                setTimeout(() => window.ai.addMsg(script.b, 'bot'), 1200);
            },

            send: (txt=null) => {
                const inp = document.getElementById('chat-inp'); 
                const content = txt || inp.value.trim(); 
                if(!content) return; 
                if(!txt) inp.value = ''; 

                window.ai.addMsg(content, 'user');
                window.ai.showTyping();

                setTimeout(() => {
                    let res = "ü§ñ Em ch∆∞a hi·ªÉu √Ω anh l·∫Øm, anh nh·∫Øn g·ªçn h∆°n ƒë∆∞·ª£c kh√¥ng ·∫°?";
                    const low = content.toLowerCase();
                    
                    // --- T√åM KI·∫æM TRONG DATA_NAO ---
                    const learned = DATA_NAO.find(x => low.includes(x.key.toLowerCase()));
                    
                    if(learned) res = "ü§ñ " + learned.ans;
                    else {
                        if(low.includes('hack') || low.includes('m·∫≠t kh·∫©u')) res = "ü§ñ V·ª• n√†y anh inbox Zalo admin ƒë·ªÉ th∆∞∆°ng l∆∞·ª£ng gi√° nha.";
                        else if(low.includes('282') || low.includes('956') || low.includes('checkpoint')) res = "ü§ñ M·ªü kh√≥a n√†y gi√° t·ª´ 199k th√¥i anh.";
                        else if(low.includes('rip') || low.includes('x√≥a')) res = "ü§ñ X√≥a nick gi√° 250k, bay m√†u vƒ©nh vi·ªÖn ·∫°.";
                        else if(low.includes('gi√°') || low.includes('nhi√™u')) res = "ü§ñ Anh b·∫•m n√∫t 'B·∫£ng Gi√° VIP' ·ªü ngo√†i ƒë·ªÉ xem chi ti·∫øt nh√©.";
                    }
                    window.ai.addMsg(res, 'bot');
                }, 1000 + Math.random() * 1000);
            },

            handleImage: async (inp) => {
                const f = inp.files[0]; if(!f) return;
                const r = new FileReader();
                r.onload = async (e) => {
                    window.ai.addMsg(e.target.result, 'user', 'image');
                    const ui = document.getElementById('scan-ui');
                    const img = document.getElementById('scan-img');
                    ui.style.display = 'flex'; img.src = e.target.result;

                    try {
                        const {data:{text}} = await Tesseract.recognize(f,'vie+eng');
                        ui.style.display = 'none';
                        const t = text.toLowerCase();
                        let diag = "ü§ñ ·∫¢nh h∆°i m·ªù, em ƒë·ªçc kh√¥ng r√µ. Anh chat tr·ª±c ti·∫øp l·ªói cho em nh√©.";

                        if(t.includes('180') || t.includes('ƒë√¨nh ch·ªâ') || t.includes('suspended')) diag = "üõë <b>Ph√°t hi·ªán l·ªói: 180 Ng√†y.</b><br>Ca n√†y kh√≥, c·∫ßn ki·ªÉm tra k·ªπ.";
                        else if(t.includes('v√¥ hi·ªáu h√≥a') || t.includes('disabled')) diag = "üö´ <b>Ph√°t hi·ªán l·ªói: FAQ/Disabled.</b><br>Inbox ƒë·ªÉ em b√°o gi√° kh√°ng.";
                        else if(t.includes('video') || t.includes('khu√¥n m·∫∑t') || t.includes('selfie')) diag = "üì∏ <b>Ph√°t hi·ªán l·ªói: Checkpoint 282.</b><br>Gi√° m·ªü: 199k.";
                        else if(t.includes('k√©t') || t.includes('b·∫£o v·ªá') || t.includes('locked')) diag = "üîí <b>Ph√°t hi·ªán l·ªói: 956 (K√©t s·∫Øt).</b><br>Gi√°: Th∆∞∆°ng l∆∞·ª£ng.";

                        window.ai.showTyping(); setTimeout(() => window.ai.addMsg(diag, 'bot'), 800);
                    } catch(e) { ui.style.display = 'none'; window.ai.addMsg("ü§ñ L·ªói h·ªá th·ªëng khi qu√©t ·∫£nh r·ªìi ·∫°.", 'bot'); }
                }; r.readAsDataURL(f);
            }
        };
    </script>
</body>
</html>